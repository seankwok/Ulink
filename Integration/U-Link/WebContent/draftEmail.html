<!DOCTYPE html>




<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="ISO-8859-1">
	<title>Draft Email</title>
	 <link href="css/bootstrap.min.css" rel="stylesheet">

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="js/jquery-1.12.0.js"></script>
	<script src="js/bootstrap.min.js"></script>
    <script> 
	    $(function(){
	      $("#includedContent").load("navBar.html"); 
	    });

    </script> 

	<style>
			.errorMsg {
			   font-size: 15px; 
			   text-align: center;
			}
				/* Dropdown Button */
			.dropbtn {
			    background-color: brown;
			    color: white;
			    padding: 8px;
			    font-size: 16px;
			    border: none;
			    cursor: pointer;
			    border-radius: 10px;
			}
			
			/* The container <div> - needed to position the dropdown content */
			.dropdown {
			    position: relative;
			    display: inline-block;
			}
			
			/* Dropdown Content (Hidden by Default) */
			.dropdown-content {
			    display: none;
			    position: absolute;
			    background-color: #f9f9f9;
			    min-width: 160px;
			    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
			    z-index: 1;
			}
			
			/* Links inside the dropdown */
			.dropdown-content a {
			    color: black;
			    padding: 12px 16px;
			    text-decoration: none;
			    display: block;
			}
			
			/* Change color of dropdown links on hover */
			.dropdown-content a:hover {background-color: #f1f1f1}
			
			/* Show the dropdown menu on hover */
			.dropdown:hover .dropdown-content {
			    display: block;
			}
			
			/* Change the background color of the dropdown button when the dropdown content is shown */
			.dropdown:hover .dropbtn {
			    background-color: #3e8e41;
			}
	</style>
	
	
	<script type="text/javascript">


		function showFields(){
			return '<html><body><%clientName><br><%clientEmail><br><%screening></body></html>'
		}
		
		function selectClientName(){
			 var myIFrame = document.getElementById('iframe');
		     var content = myIFrame.contentWindow.document.body.innerHTML;
		     console.log("old: "+content);
		     var newContent = '<clientName>';
		     console.log("new: "+content);
		}
		function selectScreening(){
			 var myIFrame = document.getElementById('iframe');
		     var content = myIFrame.contentWindow.document.body.innerHTML;
		     console.log("old: "+content);
		     var newContent = '<clientName>';
		     console.log("new: "+content);
		}
		function selectEmail(){
		 	var cursorPos = $('#text').prop('selectionStart');
            var v = $('#text').val();
            var textBefore = v.substring(0,  cursorPos );
            var textAfter  = v.substring( cursorPos, v.length );
            $('#text').val( textBefore+ " <email> " +textAfter );
		}
		function getTemplate(){
			window.location.href = "templateList.html";
		}
	    
	    function copyContent(){
	    	var frameContent="<h1> Insert title here</h1>";
	    	var doc = document.getElementById('iframe').contentWindow.document;
	    	doc.open();
	    	doc.write(frameContent);
	    	doc.close();
	    }
	    	    
	    function save(){
	    	var templateName = $('#template').val();
	    	console.log("A: "+ templateName);
	    	if (templateName == ""){
	      		$('#errMsg').html("Template Name Required!");	 	    		  
	    	}else{
	    		console.log("IN ELSE");
		    	var doc = document.getElementById('iframe').contentWindow.document;
		    	$.ajax({
					type: 'get',
					url: "CreateEmailTemplate",
					data: 'templateName=' + templateName
						+ '&'
						+ 'msg=' + doc,
					complete: function(data){
					console.log(data.responseText);			
					}
				});
		    	$('#exampleModal').modal('hide');
		    	$('#errMsg').html("");
	    	}
	    }	
		


	</script>
</head>


		
<body onload="enableEditMode();">
		<div id="includedContent"></div>
	<div align="left" >
		<div class='container'>
			<button onclick="execCmd('bold');"><b>B</b><i class="fa fa-bold"></i></button>
			<button onclick="execCmd('italic');"><i>I</i><i class="fa fa-italic"></i></button>
			<button onclick="execCmd('underline');">U<i class="fa fa-underline"></i></button>
			<button onclick="execCmd('justifyLeft');"> Left<i class="fa fa-align-left"></i></button>
			<button onclick="execCmd('justifyCenter');"> Center<i class="fa fa-align-center"></i></button>
			<button onclick="execCmd('justifyRight');"> Right<i class="fa fa-align-right"></i></button>
			<button onclick="execCmd('justifyFull');"> Full<i class="fa fa-align-justify"></i></button>
			<button onclick="execCmd('undo');">Undo<i class="fa fa-undo"></i></button>
			<button onclick="execCmd('redo');">Redo<i class="fa fa-repeat"></i></button>
			<button onclick="execCmd('insertUnorderedList');">Bullets<i class="fa fa-list-ul"></i></button>
			<button onclick="execCmd('insertOrderedList');">Number List<i class="fa fa-list-ol"></i></button>
			<select onchange="execCommandWithArg('fontName', this.value);">
				<option value="Arial">Arial</option>
				<option value="Comic Sans MS">Comic Sans MS</option>
				<option value="Courier">Courier</option>
				<option value="Georgia">Georgia</option>
				<option value="Tahoma">Tahoma</option>
				<option value="Times New Roman">Times New Roman</option>
				<option value="Verdana">Verdana</option>
			</select>
			<select onchange="execCommandWithArg('fontSize', this.value);">
				<option value="1">9</option>
				<option value="2">10</option>
				<option value="3">11</option>
				<option value="4" selected="selected">12</option>
				<option value="5">13</option>
				<option value="6">14</option>
				<option value="8">15</option>
				<option value="9">16</option>
				<option value="10">17</option>
				<option value="11">18</option>
			</select>
			Font Color: <input type="color" onchange="execCommandWithArg('foreColor', this.value);">
			<button onclick="execCmd('selectAll');">Select All</button>	
			<br><br>
			<button onclick='copyContent()'>Get from Template</button>
			<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Save as Template</button>


<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="exampleModalLabel"><b>Save Template As</b></h4>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="message-text" class="form-control-label">Template Name:</label>
            <textarea class="form-control" id="template" ></textarea>
	            <div class="modal-footer">
	        		<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
	        		<input type="button" class="btn btn-primary" onClick='save()' value='save'> 
	     		 </div>
          </div>
        </form>
        <div id='errMsg' style='color:red' class='errorMsg'></div>
        
      </div>
    </div>
  </div>
</div>	
		</div>
		<br>
	</div>				
		
		<br>
		<div class='container' >
			<iframe id="iframe"  src="javascript:parent.showFields()" name="richTextField" style="width: 1000px; height: 500px;"></iframe>
			<br><div align='center'><button>Send to ...</button></div>
		</div>	

		<script type="text/javascript">

			var showingSourceCode = false;
			var isInEditMode = true;

			function enableEditMode () {
				richTextField.document.designMode = 'On';
			}

			function execCmd (command) {
				richTextField.document.execCommand(command, false, null);
			}

			function execCommandWithArg (command, arg) {
				richTextField.document.execCommand(command, false, arg);
			}


		</script>
		
	</body>
</html>